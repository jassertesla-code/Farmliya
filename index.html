<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Farmliya â€” Ø´Ø­Ù† + Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª PUBG</title>
  <style>
    :root{
      --card: rgba(255,255,255,0.04);
      --gold1:#f0c75e; --gold2:#d9a441; --muted:#9fb0b7;
    }
    *{box-sizing:border-box}
    body{font-family:Tahoma,Arial,Helvetica;background:#041226;color:#eaf6f2;margin:0;padding:18px}
    .container{max-width:1000px;margin:0 auto}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(90deg,var(--gold1),var(--gold2));display:flex;align-items:center;justify-content:center;color:#071018;font-weight:900}
    h1{margin:0;font-size:18px}
    nav.tabs{display:flex;gap:8px}
    .tab{padding:8px 14px;border-radius:10px;background:transparent;color:var(--muted);cursor:pointer;border:1px solid rgba(255,255,255,0.03)}
    .tab.active{background:linear-gradient(90deg, rgba(240,199,94,0.12), rgba(217,164,65,0.08));color:#fff}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px}
    .card{background:var(--card);padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    input,select,textarea,button{font-family:inherit;font-size:15px}
    input[type="text"],select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:inherit}
    .row{display:flex;gap:10px}
    .col{flex:1}
    .btn{padding:10px 14px;border-radius:10px;border:0;cursor:pointer;background:linear-gradient(90deg,var(--gold1),var(--gold2));color:#071018;font-weight:800}
    .btn.secondary{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.03)}
    .muted{color:var(--muted)}
    .result{margin-top:10px;padding:10px;border-radius:10px;background:rgba(0,0,0,0.18)}
    pre{white-space:pre-wrap;font-size:13px;color:#eaf6f2;margin:0}
    footer{text-align:center;color:var(--muted);margin-top:18px;font-size:13px}

    /* splash */
    #splash{position:fixed;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(4,6,10,0.98), rgba(2,4,6,0.98))}
    .splash-box{width:min(520px,92%);text-align:center;padding:28px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.04)}
    .progress-wrap{height:10px;background:rgba(255,255,255,0.03);border-radius:10px;overflow:hidden;margin-top:12px}
    .progress-bar{height:100%;width:0%;background:linear-gradient(90deg,var(--gold1),var(--gold2));transition:width .18s linear}
    @media (max-width:900px){ .grid{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div id="splash">
    <div class="splash-box">
      <div style="display:inline-block;padding:6px 12px;border-radius:8px;background:linear-gradient(90deg,var(--gold1),var(--gold2));color:#071018;font-weight:800">UC</div>
      <h2 style="margin:10px 0 0">Farmliya</h2>
      <p class="muted" style="margin:6px 0 0">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© â€” Ù„Ø­Ø¸Ø© ÙˆØ§Ø­Ø¯Ø©...</p>
      <div class="progress-wrap"><div id="splashBar" class="progress-bar"></div></div>
      <div class="muted" style="margin-top:8px">Ø³ÙŠØ¨Ø¯Ø£ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø¹Ø¯ <span id="splashSeconds">5</span> Ø«ÙˆØ§Ù†Ù</div>
    </div>
  </div>

  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">UC</div>
        <div>
          <h1>Farmliya â€” Ø´Ø­Ù† Ø´Ø¯Ø§Øª Ø¨Ø¨Ø¬ÙŠ</h1>
          <div class="muted">ÙˆØ§Ø¬Ù‡Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© (ØªØ¬Ø±ÙŠØ¨ÙŠØ©)</div>
        </div>
      </div>

      <nav class="tabs" id="tabs">
        <div class="tab active" data-tab="home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
        <div class="tab" data-tab="stats">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨</div>
      </nav>
    </header>

    <div class="grid">
      <!-- left: content -->
      <main>
        <!-- Home section (charge form) -->
        <section id="home" class="card section">
          <h3 style="margin-top:0">âš¡ Ø§Ø´Ø­Ù† Ø´Ø¯Ø§Øª Ø¨Ø¨Ø¬ÙŠ Ø§Ù„Ø¢Ù†</h3>
          <form id="chargeForm">
            <label>ğŸ® Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ (Player ID)</label>
            <input id="playerId" type="text" placeholder="Ù…Ø«Ø§Ù„: 123456789" required>
            <div class="row" style="margin-top:8px">
              <div class="col">
                <label>ğŸ’° Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø¯Ø§Øª (UC)</label>
                <select id="ucAmount" required>
                  <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ…ÙŠØ©</option>
                  <option value="60">60 UC</option>
                  <option value="300">300 UC</option>
                  <option value="600">600 UC</option>
                  <option value="1200">1200 UC</option>
                </select>
              </div>
              <div class="col">
                <label>ğŸŒ Ø§Ù„Ø³ÙŠØ±ÙØ±</label>
                <select id="server" required>
                  <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø³ÙŠØ±ÙØ±</option>
                  <option value="ASIA">ASIA</option>
                  <option value="EUROPE">EUROPE</option>
                  <option value="NA">NORTH AMERICA</option>
                </select>
              </div>
            </div>

            <label style="margin-top:8px">ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <input id="playerName" type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨">

            <div style="margin-top:12px">
              <label><input id="consent" type="checkbox"> Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ ÙÙ‚Ø·.</label>
            </div>

            <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
              <button class="btn" type="submit">Ø§Ø´Ø­Ù† Ø§Ù„Ø¢Ù† âš¡</button>
              <button class="btn secondary" id="clearBtn" type="button">Ù…Ø³Ø­</button>
            </div>

            <div id="formStatus" class="result" style="display:none"></div>
          </form>
        </section>

        <!-- Stats section (hidden by default) -->
        <section id="stats" class="card section" style="display:none">
          <h3 style="margin-top:0">ğŸ” Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨</h3>
          <p class="muted">Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø£Ùˆ ID ÙˆØ§Ø®ØªØ± Ø§Ù„Ù…Ù†ØµØ© Ø«Ù… Ø§Ø¶ØºØ· "Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª". <br><strong>Ù…Ù„Ø§Ø­Ø¸Ø© Ø£Ù…Ù†ÙŠÙ‘Ø©:</strong> Ø§Ù„Ù…ÙØªØ§Ø­ Ø³ÙŠØªÙ… ÙˆØ¶Ø¹Ù‡ Ø¯Ø§Ø®Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù â€” Ù‡Ø°Ø§ ØºÙŠØ± Ø¢Ù…Ù†. Ø£Ù†ØµØ­ Ø¨Ø§Ù„Ø­Ù„ Ø§Ù„Ø¢Ù…Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù….</p>

          <div style="display:grid;grid-template-columns:1fr 160px;gap:10px">
            <input id="checkInput" type="text" placeholder="Ø¶Ø¹ Player name Ø£Ùˆ Player ID (Ù…Ø«Ø§Ù„: someplayer Ø£Ùˆ 123456789)">
            <select id="checkPlatform">
              <option value="steam">PC (Steam)</option>
              <option value="psn">PlayStation</option>
              <option value="xbox">Xbox</option>
            </select>
          </div>

          <div style="margin-top:10px;display:flex;gap:8px">
            <button id="btnFetch" class="btn">Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
            <button id="btnFetchSeason" class="btn secondary">Ø¬Ù„Ø¨ Ø¥Ø­ØµØ§Ø¡Ø§Øª Ù…ÙˆØ³Ù… (Ù…Ø¹ Season ID)</button>
          </div>

          <div style="margin-top:10px">
            <label>Season ID (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø§Ù„Ù…ÙˆØ³Ù…):</label>
            <input id="seasonId" type="text" placeholder="Ù…Ø«Ø§Ù„: division.bro.official.pc-2018 (Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºÙ‹Ø§ Ø¥Ù† Ù„Ù… ØªÙƒÙ† ØªÙ…Ù„Ùƒ ID)">
          </div>

          <div id="statsResult" class="result" style="display:none"></div>
        </section>
      </main>

      <!-- right: info / logs -->
      <aside>
        <div class="card">
          <h4 style="margin:0 0 8px 0">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª / ØªØ­Ø°ÙŠØ±</h4>
          <p class="muted" style="font-size:13px">
            Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ØªØ³ØªØ®Ø¯Ù… PUBG Developer API Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­ (client-side). Ø¥Ù† ÙˆØ¶Ø¹Øª Ø§Ù„Ù…ÙØªØ§Ø­ Ù‡Ù†Ø§:
            <ul style="margin:6px 0 0 18px;color:var(--muted);padding-left:6px">
              <li>Ø£ÙŠÙ‘ Ù…ØªØµÙØ­ ÙŠØ³ØªØ·ÙŠØ¹ Ø±Ø¤ÙŠØªÙ‡ (ØºÙŠØ± Ø¢Ù…Ù†).</li>
              <li>ÙŠÙˆØµÙ‰ Ø¨Ø´Ø¯Ù‘Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø§Ø¯Ù… ÙˆØ³ÙŠØ· (proxy backend).</li>
              <li>Ø¥Ø°Ø§ Ù‚Ø±Ø±Øª Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© â€” Ø¶Ø¹ Ø§Ù„Ù…ÙØªØ§Ø­ ÙÙŠ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ù…Ø´Ø§Ø± Ø¥Ù„ÙŠÙ‡ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø£Ø¯Ù†Ø§Ù‡.</li>
            </ul>
          </p>
        </div>
      </aside>
    </div>

    <footer>â’¸ Farmliya â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</footer>
  </div>

<script>
/* ========== IMPORTANT: Ø¶Ø¹ Ù…ÙØªØ§Ø­ PUBG Ù‡Ù†Ø§ ÙÙ‚Ø· Ø¥Ù† ÙƒÙ†Øª Ù…ÙˆØ§ÙÙ‚Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø®Ø§Ø·Ø± ============
   Ù…Ø«Ø§Ù„:
   const PUBG_API_KEY = "eyJ...";   // Ø¶Ø¹ Ø§Ù„ØªÙˆÙƒÙ† Ù‡Ù†Ø§ (YOUR KEY)
   ----- Ù†ØµÙŠØ­Ø© Ø£Ù…Ø§Ù† -----
   Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ ÙŠØ¹Ø±Ø¶ Ø§Ù„Ù…ÙØªØ§Ø­ Ù„ÙƒÙ„ Ù…Ù† ÙŠÙØªØ­ ØµÙØ­Ø© Ø§Ù„ÙˆÙŠØ¨. Ø§Ù„Ø£ÙØ¶Ù„ Ø¯Ø§Ø¦Ù…Ø§Ù‹: backend proxy.
============================================================================= */
const PUBG_API_KEY = "PASTE_YOUR_PUBG_API_KEY_HERE";
/* =========================================================================== */

/* helper */
function el(id){ return document.getElementById(id); }
function show(elm, txt){ elm.style.display='block'; elm.innerHTML = txt; }
function hide(elm){ elm.style.display='none'; }

/* splash */
(function(){
  const bar = el('splashBar'), sec = el('splashSeconds');
  const D=5; let start = performance.now();
  const id = setInterval(()=>{
    const elapsed=(performance.now()-start)/1000;
    const pct = Math.min(100,(elapsed/D)*100);
    bar.style.width = pct + '%';
    sec.textContent = Math.max(0,Math.ceil(D-elapsed));
    if(elapsed>=D){ clearInterval(id); el('splash').remove(); }
  },80);
})();

/* tabs */
document.querySelectorAll('.tab').forEach(t=>{
  t.addEventListener('click', ()=>{
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    const tab = t.dataset.tab;
    document.querySelectorAll('.section').forEach(s=>s.style.display='none');
    el(tab).style.display = 'block';
    window.scrollTo({top:0,behavior:'smooth'});
  });
});

/* ========== PUBG client-side calls (unsafe but requested) ========== */

async function fetchPubgPlayersByName(name, platform='steam'){
  const url = `https://api.pubg.com/shards/${platform}/players?filter[playerNames]=${encodeURIComponent(name)}`;
  const resp = await fetch(url, {
    headers: {
      'Authorization': `Bearer ${PUBG_API_KEY}`,
      'Accept': 'application/vnd.api+json'
    }
  });
  if(!resp.ok){
    const text = await resp.text().catch(()=>'');
    throw { status: resp.status, text };
  }
  return await resp.json();
}

async function fetchPubgPlayerById(playerId, platform='steam'){
  const url = `https://api.pubg.com/shards/${platform}/players/${encodeURIComponent(playerId)}`;
  const resp = await fetch(url, {
    headers: {
      'Authorization': `Bearer ${PUBG_API_KEY}`,
      'Accept': 'application/vnd.api+json'
    }
  });
  if(!resp.ok){
    const text = await resp.text().catch(()=>'');
    throw { status: resp.status, text };
  }
  return await resp.json();
}

async function fetchSeasonStats(playerId, platform='steam', seasonId){
  const url = `https://api.pubg.com/shards/${platform}/players/${encodeURIComponent(playerId)}/seasons/${encodeURIComponent(seasonId)}`;
  const resp = await fetch(url, {
    headers: {
      'Authorization': `Bearer ${PUBG_API_KEY}`,
      'Accept': 'application/vnd.api+json'
    }
  });
  if(!resp.ok){
    const text = await resp.text().catch(()=>'');
    throw { status: resp.status, text };
  }
  return await resp.json();
}

/* UI handlers for stats */
el('btnFetch').addEventListener('click', async ()=>{
  const q = el('checkInput').value.trim();
  const platform = el('checkPlatform').value;
  const out = el('statsResult');
  if(!q){ show(out, '<span class="muted">Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ù‹Ø§ Ø£Ùˆ ID Ù„Ù„Ø§Ø¹Ø¨.</span>'); return; }
  if(!PUBG_API_KEY || PUBG_API_KEY.includes('PASTE_YOUR')){ show(out, '<span style="color:#ff9b9b">Ø¶Ø¹ Ù…ÙØªØ§Ø­ PUBG ÙÙŠ Ø§Ù„Ù…ØªØºÙŠØ± PUBG_API_KEY Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù„Ù.</span>'); return; }
  show(out, 'ğŸ”„ Ø¬Ø§Ø±Ù Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨...');

  try{
    let playerData = null;
    if(/^\d+$/.test(q) || q.includes('-')) {
      // likely player ID (ids contain hyphens), try direct fetch by ID
      playerData = await fetchPubgPlayerById(q, platform);
    } else {
      // fetch by name
      const res = await fetchPubgPlayersByName(q, platform);
      if(!res || !res.data || !res.data.length) throw { message: 'Ù„Ù… ÙŠØ¹Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù„Ø§Ø¹Ø¨' };
      playerData = res;
    }

    // get first record and display basic info
    const p = (playerData.data && playerData.data[0]) || playerData.data; // some endpoints return data object
    const attr = p.attributes || {};
    const id = p.id || (p && p.id);
    const name = attr.name || (p && p.attributes && p.attributes.name);
    const createdAt = attr.createdAt || (p && p.attributes && p.attributes.createdAt);

    // try best-effort to extract relationships.matches first id and fetch match time
    let lastMatchTime = null;
    try{
      const rels = p.relationships || (playerData.data && playerData.data[0] && playerData.data[0].relationships) || {};
      const matches = (rels.matches && rels.matches.data) || [];
      if(matches && matches.length){
        const matchId = matches[0].id;
        // fetch match to get createdAt
        const mresp = await fetch(`https://api.pubg.com/shards/${platform}/matches/${matchId}`, {
          headers: { 'Authorization': `Bearer ${PUBG_API_KEY}`, 'Accept': 'application/vnd.api+json' }
        });
        if(mresp.ok){
          const mj = await mresp.json();
          lastMatchTime = mj.data && mj.data.attributes && mj.data.attributes.createdAt;
        }
      }
    }catch(e){ /* ignore */ }

    // build html
    let html = `<div><strong>Ø§Ù„Ù„Ø§Ø¹Ø¨:</strong> ${name || 'â€”' } <small class="muted">(${id})</small></div>`;
    html += `<div><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:</strong> ${createdAt ? new Date(createdAt).toLocaleString() : 'ØºÙŠØ± Ù…ØªØ§Ø­'}</div>`;
    if(lastMatchTime) html += `<div><strong>Ø¢Ø®Ø± Ù…Ø¨Ø§Ø±Ø§Ø© Ù…Ø³Ø¬Ù„Ø©:</strong> ${new Date(lastMatchTime).toLocaleString()}</div>`;
    html += `<div style="margin-top:8px" class="muted">Ù…Ù„Ø§Ø­Ø¸Ø©: API Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ø§ ÙŠØ¹Ø·ÙŠ Ø­Ø§Ù„Ø© Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©Ø› Ù‡Ø°Ù‡ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³Ø¬Ù„Ø© ÙÙ‚Ø· (Ø¢Ø®Ø± Ù…Ø¨Ø§Ø±Ø§Ø© Ø¥Ù† ÙˆÙØ¬Ø¯Øª).</div>`;

    show(out, html);
  }catch(err){
    console.error(err);
    const msg = (err && (err.message || err.text)) || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ â€” ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙØªØ§Ø­ ÙˆØ§Ø³Ù…/ID Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙˆØ§Ù„Ù…Ù†ØµØ©.';
    show(out, `<span style="color:#ff9b9b">Ø®Ø·Ø£: ${msg}</span>`);
  }
});

/* fetch season stats button */
el('btnFetchSeason').addEventListener('click', async ()=>{
  const q = el('checkInput').value.trim();
  const platform = el('checkPlatform').value;
  const seasonId = el('seasonId').value.trim();
  const out = el('statsResult');
  if(!q){ show(out, '<span class="muted">Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ù‹Ø§ Ø£Ùˆ ID Ù„Ù„Ø§Ø¹Ø¨.</span>'); return; }
  if(!seasonId){ show(out, '<span class="muted">Ø£Ø¯Ø®Ù„ Season ID ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ Ø§Ù„Ù…Ø®ØµØµ Ø£ÙˆÙ„Ù‹Ø§.</span>'); return; }
  if(!PUBG_API_KEY || PUBG_API_KEY.includes('PASTE_YOUR')){ show(out, '<span style="color:#ff9b9b">Ø¶Ø¹ Ù…ÙØªØ§Ø­ PUBG ÙÙŠ Ø§Ù„Ù…ØªØºÙŠØ± PUBG_API_KEY Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù„Ù.</span>'); return; }
  show(out, 'ğŸ”„ Ø¬Ù„Ø¨ Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø§Ù„Ù…ÙˆØ³Ù… â€” Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„...');

  try{
    // resolve player id first
    let playerId = null;
    if(/^\d+$/.test(q) || q.includes('-')) {
      playerId = q;
    } else {
      const res = await fetchPubgPlayersByName(q, platform);
      if(!res || !res.data || !res.data.length) throw { message:'Ù„Ù… ÙŠØ¹Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù„Ø§Ø¹Ø¨' };
      playerId = res.data[0].id;
    }

    const seasonJson = await fetchSeasonStats(playerId, platform, seasonId);
    // seasonJson format: data.attributes.gameModeStats or included stats depending on API
    // We'll try to show a readable summary
    const attrs = (seasonJson.data && seasonJson.data.attributes) || {};
    const gms = attrs.gameModeStats || attrs; // sometimes nested
    let html = `<div><strong>Ø§Ù„Ù„Ø§Ø¹Ø¨ (ID):</strong> ${playerId}</div>`;
    html += `<div style="margin-top:8px"><strong>Season ID:</strong> ${seasonId}</div>`;

    if(gms && typeof gms === 'object' && Object.keys(gms).length){
      html += `<div style="margin-top:8px"><strong>Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø­Ø³Ø¨ Ù†Ù…Ø· Ø§Ù„Ù„Ø¹Ø¨:</strong></div>`;
      for(const mode of Object.keys(gms)){
        const s = gms[mode];
        html += `<div style="margin:6px 0;padding:8px;border-radius:8px;background:rgba(0,0,0,0.12)"><strong>${mode}</strong><br/>`;
        // display a few common fields if present
        const keys = ['roundsPlayed','wins','kills','assists','damageDealt','longestKill','timeSurvived','kd'];
        for(const k of keys){
          if(s[k] !== undefined) html += `<small class="muted">${k}:</small> ${s[k]} &nbsp; `;
        }
        html += `</div>`;
      }
    } else {
      html += `<div class="muted">Ù„Ù… ØªÙØ±Ø¬Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø­ØµØ§Ø¦ÙŠØ© ÙˆØ§Ø¶Ø­Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ³Ù…. Ø±Ø§Ø¬Ø¹ Season ID Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙØµÙ‘Ø¯Ø±ÙØ© Ù…Ù† PUBG API.</div>`;
    }

    show(out, html);
  }catch(err){
    console.error(err);
    const msg = (err && (err.message || err.text)) || 'Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø§Ù„Ù…ÙˆØ³Ù…';
    show(out, `<span style="color:#ff9b9b">Ø®Ø·Ø£: ${msg}</span>`);
  }
});

/* ========== charge form (same as Ù‚Ø¨Ù„ but client-side send to Telegram if you used token) ========== */
el('chargeForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const playerId = el('playerId').value.trim();
  const uc = el('ucAmount').value;
  const server = el('server').value;
  const playerName = el('playerName').value.trim();
  const consent = el('consent').checked;
  const status = el('formStatus'); status.style.display='block';
  if(!playerId || !uc || !server || !consent){ status.innerHTML = '<span style="color:#ff9b9b">Ø§Ù…Ù„Ø£ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù….</span>'; return; }

  // NOTE: sending directly to Telegram API from client is insecure if token placed here.
  // If you insist, you can paste TELEGRAM_BOT_TOKEN and CHAT_ID here and it will attempt to send.
  status.textContent = 'Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';

  try{
    // Example: attempt client-side send (UNSAFE) only if you define TELEGRAM_BOT_TOKEN and TELEGRAM_CHAT_ID below
    // const TELEGRAM_BOT_TOKEN = "PASTE_YOUR_TELEGRAM_BOT_TOKEN_HERE";
    // const TELEGRAM_CHAT_ID = "5653032481";
    // if(TELEGRAM_BOT_TOKEN && !TELEGRAM_BOT_TOKEN.includes('PASTE')){
    //   const resp = await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
    //     method:'POST',
    //     headers: {'Content-Type':'application/json'},
    //     body: JSON.stringify({ chat_id: TELEGRAM_CHAT_ID, text:
    //       `ğŸ¯ Ø·Ù„Ø¨ Ø´Ø­Ù† Ø¬Ø¯ÙŠØ¯\nID: ${playerId}\nUC: ${uc}\nServer: ${server}\nName: ${playerName}`
    //     })
    //   });
    //   if(resp.ok){ status.innerHTML = '<span style="color:#b7f3c1">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„!</span>'; el('chargeForm').reset(); return; }
    // }

    // Fallback if TELEGRAM not set client-side
    status.innerHTML = '<span class="muted">ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø­Ù„ÙŠÙ‹Ø§ (Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ØºÙŠØ± Ø§Ù„Ø¢Ù…Ù† Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­). Ø£Ù†ØµØ­ Ø¨Ø¹Ù…Ù„ backend Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„.</span>';
    // Save a local copy (localStorage)
    const logs = JSON.parse(localStorage.getItem('farmliya_local_logs')||'[]');
    logs.unshift({time:new Date().toLocaleString(), playerId, uc, server, playerName});
    localStorage.setItem('farmliya_local_logs', JSON.stringify(logs.slice(0,200)));
    el('chargeForm').reset();
  }catch(err){
    console.error(err);
    status.innerHTML = '<span style="color:#ff9b9b">Ø­ØµÙ„ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.</span>';
  }
});

/* clear button */
el('clearBtn').addEventListener('click', ()=>{ el('chargeForm').reset(); el('formStatus').style.display='none'; });

</script>
</body>
</html>
