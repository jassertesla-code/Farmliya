<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>APP JOJO ♡ JASSER</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --bg1:#081126; --bg2:#3b0066; --accent:#ff5fb4; --paper:#fff8f5; --text-dark:#3b2340;
  --petal1:#ffb6e6; --petal2:#ffd6fb; --petal3:#ff9ad4;
}
*{box-sizing:border-box}
body{
  margin:0; min-height:100vh;
  font-family:'Cairo',sans-serif;
  background:
    radial-gradient(700px 400px at 10% 10%, rgba(255,95,180,0.05), transparent),
    linear-gradient(180deg,var(--bg1),var(--bg2));
  color:#fff; display:flex; flex-direction:column; align-items:center; padding:28px; overflow:hidden;
}

/* ===== Header: الخط العمودي ثم العنوان يظهر من اليمين ===== */
.header {
  width:100%; max-width:960px; display:flex; flex-direction:column; align-items:center; gap:8px;
}
.line {
  width:2px; height:0; background:linear-gradient(180deg,#ffd6fb,#ff9ad4); border-radius:2px;
  opacity:0.95; transform-origin: top center; animation: drawLine 700ms ease forwards;
}
@keyframes drawLine { from {height:0;} to {height:72px;} }

/* عنوان ينزلق من اليمين */
.title {
  font-size:34px; font-weight:900; letter-spacing:1px; opacity:0; transform:translateX(40px);
  display:inline-block; animation: slideIn 700ms cubic-bezier(.2,.9,.2,1) 900ms forwards;
  -webkit-background-clip: text; background-clip:text;
  background: linear-gradient(90deg,#ffd6fb,#ff7ab6 40%, #ffd6fb 100%); color:transparent;
  text-shadow: 0 12px 30px rgba(255,100,170,0.08);
}
@keyframes slideIn {
  to { opacity:1; transform:none; }
}

/* subtle fade out a bit but keep visible (not vanish completely) */
.title.faded { animation: fadeTitle 1s ease 4s forwards; }
@keyframes fadeTitle { to { opacity:0.65; transform:translateY(-6px);} }

/* قلب يحتوي على التاريخ */
.heart {
  width:68px;height:68px;border-radius:999px;
  background:linear-gradient(180deg,#ff7ab6,#ff3b90);
  display:flex;align-items:center;justify-content:center;font-weight:900;color:#fff;
  box-shadow:0 14px 40px rgba(255,70,150,0.12); position:relative;
  margin-top:6px;
}
.heart .date { font-size:11px; font-weight:700; text-align:center; line-height:1; }

/* ===== Back decoration: petals (floating) ===== */
.petal {
  position:absolute; width:18px; height:22px; border-radius:8px;
  opacity:0.95; transform-origin:center; pointer-events:none;
  filter: drop-shadow(0 6px 18px rgba(0,0,0,0.25));
}
@keyframes floatPetal {
  from { transform: translateY(-20vh) rotate(0deg) scale(0.9); opacity:0; }
  20% { opacity:1; }
  to { transform: translateY(120vh) rotate(720deg) scale(1.1); opacity:0; }
}

/* ===== Gift area ===== */
.stage { width:100%; max-width:680px; margin-top:32px; display:flex; justify-content:center; align-items:center; position:relative; padding:20px; }
.gift { width:260px; height:200px; position:relative; perspective:1200px; cursor:pointer; }
.box-base {
  width:100%; height:64%; background: linear-gradient(180deg,#3b002f,#210016);
  border-radius:14px; position:absolute; bottom:0; left:0; z-index:6; box-shadow:0 26px 60px rgba(0,0,0,0.6);
  display:flex; align-items:center; justify-content:center; overflow:visible; transform-origin:center top;
  transition: transform 700ms cubic-bezier(.2,.95,.15,1), opacity 600ms ease;
}
.ribbon-vertical { position:absolute; left:50%; transform:translateX(-50%); width:40px; height:100%; border-radius:6px; background: linear-gradient(180deg,#ff9bd1,#ff4aa3); z-index:7; }
.ribbon-horizontal { position:absolute; top:30%; left:0; width:100%; height:34px; border-radius:8px; background: linear-gradient(90deg,#ff9bd1,#ff4aa3); z-index:7; }
.bow { position:absolute; top:-18px; left:50%; transform:translateX(-50%) rotate(-10deg); width:96px; height:56px; border-radius:20px; background: linear-gradient(180deg,#ffd1e8,#ff86c4); z-index:9; box-shadow:0 8px 26px rgba(255,91,158,0.12); }
.box-lid {
  width:100%; height:50%; position:absolute; top:0; left:0; border-radius:14px; background: linear-gradient(180deg,#6f0045,#3a001f);
  transform-origin: top center; z-index:10; transition: transform 700ms cubic-bezier(.2,.95,.15,1), opacity 600ms ease; box-shadow:0 26px 40px rgba(0,0,0,0.5);
}

/* الورقة (الملاحظة) */
.note {
  position:absolute; left:50%; transform:translateX(-50%) translateY(8px) rotate(-8deg);
  top:44%; width:200px; padding:18px; background: var(--paper); color: var(--text-dark);
  border-radius:10px; box-shadow: 0 26px 60px rgba(0,0,0,0.35); opacity:0; z-index:4;
  transform-origin: bottom center; transition: all 900ms cubic-bezier(.2,.9,.2,1); text-align:center; font-weight:700; line-height:1.35;
}

/* عند الفتح: اختفاء الصندوق وظهور الورقة */
.opened .box-lid { transform: translateY(-20px) rotateX(65deg) scale(1.02); opacity:0; }
.opened .box-base { opacity:0; transform: translateY(12px) scale(0.9); pointer-events:none; }
.opened .note { opacity:1; top:-22%; transform:translateX(-50%) translateY(0) rotate(0deg); z-index:30; }

/* الرسالة داخل الورقة */
.message { font-size:15px; color:#4b2340; }
.message .from { display:block; margin-top:10px; font-weight:900; color:#2b1840; font-size:15px; }

/* زر تشغيل/ايقاف الموسيقى */
.audio-toggle {
  position:fixed; right:16px; bottom:16px; z-index:1200;
  background:linear-gradient(90deg,#ff9bd1,#ff4aa3); color:#fff; border:none; padding:10px 14px; border-radius:999px; font-weight:800; cursor:pointer; box-shadow:0 8px 24px rgba(255,90,150,0.14);
}

/* confetti canvas (above everything) */
.confetti { position:fixed; inset:0; pointer-events:none; z-index:1000; }

/* responsive */
@media (max-width:480px){
  .gift{width:200px;height:150px;} .note{width:160px; top:44%} .title{font-size:24px} .heart{width:60px;height:60px}
}
</style>
</head>
<body>

  <div class="header" aria-hidden="false">
    <div class="line" id="line"></div>
    <div class="title" id="titleText"><span>APP JOJO ♡ JASSER</span></div>
    <div style="margin-top:6px;">
      <div class="heart" aria-hidden="true"><div class="date" id="dateInHeart"></div></div>
    </div>
  </div>

  <div class="stage">
    <div class="gift" id="giftCard" title="اضغط لفتح الهدية">
      <div class="box-lid" aria-hidden="true"></div>
      <div class="box-base" aria-hidden="true">
        <div class="ribbon-vertical"></div>
        <div class="ribbon-horizontal"></div>
        <div class="bow" aria-hidden="true"></div>
      </div>

      <div class="note" id="noteCard" role="dialog" aria-hidden="true">
        <div class="message" id="messageText"></div>
        <span class="from">— جَاسِر ❤</span>
      </div>
    </div>
  </div>

  <canvas class="confetti" id="confettiCanvas"></canvas>
  <button class="audio-toggle" id="audioToggle">تشغيل الموسيقى</button>

  <!-- ضع ملف romantic.mp3 في نفس المجلد (أو غيّر المسار هنا) -->
  <audio id="bgm" src="romantic.mp3" preload="auto" loop></audio>

<script>
/* ======== رسائل يومية ======== */
const messages = [
  "جوجو الحبيبة، كل يومٍ معكِ يكبر قلبي فرحًا — ضحكتكِ نوري.",
  "حبيبتي جوجو، أنتِ الحلم الذي تحقّق في أيامي. أحبكِ بلا حدود.",
  "جوجو الغالية، كل لحظة بقربك أجمل من كل ما مرّ — وأنتِ سر سعادتي.",
  "إلى جوجو، يا أجمل نعمة، شكراً لوجودك؛ أحبكِ بكل نبضة في قلبي.",
  "جوجو، كلامي قد لا يكفيكِ، لكن قلبي يهديكِ عمراً من الحب والوفاء.",
  "يا جوجو، ضحكتكِ موسيقى تُنعش روحي — أنتِ لي كل المعاني.",
  "إلى جوجو، مع كل شروق أراكِ أجمل — لكِ وحدك قلبي وهواي.",
  "جوجو، وجودكِ يجعل كل يوم ينبض أملًا؛ أحبكِ فوق كل وصف.",
  "غاليتي جوجو، كنز قلبي أنتِ، كل يوم أحبك أكثر من البارحة.",
  "جوجو الحبيبة، معكِ تعلمتُ معنى السعادة الحقيقية — دمتِ لي نورًا."
];

function getDayIndex(date = new Date()){
  const msPerDay = 24*60*60*1000;
  const days = Math.floor(date.getTime() / msPerDay);
  return days % messages.length;
}
function updateDailyMessage(){
  const idx = getDayIndex(new Date());
  const text = messages[idx];
  document.getElementById('messageText').innerHTML = text;
  localStorage.setItem('last_message_date', new Date().toDateString());
}

/* ======== عرض التاريخ في القلب ======== */
function showDate(){
  const d = new Date();
  document.getElementById('dateInHeart').textContent =
    d.toLocaleDateString('ar-DZ', { year:'numeric', month:'long', day:'numeric' });
}
showDate();
updateDailyMessage();

/* ======== Title fade small tweak after showing ======== */
window.addEventListener('load', ()=> {
  const title = document.getElementById('titleText');
  // بعد 4.5 ثانية نجعل العنوان هادئ قليلاً (ليس اختفاء كامل)
  setTimeout(()=> title.classList.add('faded'), 4500);
});

/* ======== Petals background generation ======== */
function spawnPetals(n=14){
  for(let i=0;i<n;i++){
    const p = document.createElement('div');
    p.className='petal';
    const size = 10 + Math.random()*28;
    p.style.width = size+'px';
    p.style.height = (size*1.1)+'px';
    const colors = [getComputedStyle(document.documentElement).getPropertyValue('--petal1').trim(),
                    getComputedStyle(document.documentElement).getPropertyValue('--petal2').trim(),
                    getComputedStyle(document.documentElement).getPropertyValue('--petal3').trim()];
    p.style.background = colors[Math.floor(Math.random()*colors.length)];
    p.style.left = (Math.random()*100)+'%';
    p.style.top = (-20 - Math.random()*30)+'%';
    p.style.opacity = 0.95;
    p.style.transform = `rotate(${Math.random()*360}deg)`;
    p.style.animation = `floatPetal ${8+Math.random()*10}s linear ${Math.random()*2}s forwards`;
    document.body.appendChild(p);
    // remove eventually
    setTimeout(()=> p.remove(), 20000);
  }
}
spawnPetals(18);
setInterval(()=> spawnPetals(8), 7000);

/* ======== Gift open behavior & confetti ======== */
const gift = document.getElementById('giftCard');
const confettiCanvas = document.getElementById('confettiCanvas');
let opened = false;

gift.addEventListener('click', openGift);

function openGift(){
  if(opened) return;
  opened = true;
  gift.classList.add('opened');
  updateDailyMessage();
  playMusicIfPossible();
  launchConfetti();
}

/* ======== Audio handling ======== */
const bgm = document.getElementById('bgm');
const audioToggle = document.getElementById('audioToggle');
let audioPlaying = false;

// حاول التشغيل التلقائي (سيُرفض غالبًا بدون تفاعل) — نتجاهل الأخطاء
bgm.play().then(()=> { audioPlaying = true; audioToggle.textContent = 'إيقاف الموسيقى'; })
.catch(()=> { /* ممنوع تلقائياً -> سينطلق بعد التفاعل */ });

// تشغيل عند فتح الهدية إذا لم يشغل تلقائياً
function playMusicIfPossible(){
  if(audioPlaying) return;
  bgm.play().then(()=> { audioPlaying = true; audioToggle.textContent = 'إيقاف الموسيقى'; })
  .catch(()=> { /* لا مشكلة */ });
}

// زر تشغيل/ايقاف
audioToggle.addEventListener('click', ()=>{
  if(!audioPlaying){
    bgm.play().then(()=> { audioPlaying = true; audioToggle.textContent = 'إيقاف الموسيقى'; })
    .catch(()=> { alert('التشغيل تلقائيًا محجوب — اضغط أولًا على الهدية أو تفاعل مع الصفحة.'); });
  } else {
    bgm.pause(); bgm.currentTime = 0; audioPlaying = false; audioToggle.textContent = 'تشغيل الموسيقى';
  }
});

/* ======== Confetti (canvas) ======== */
function launchConfetti(){
  try {
    const canvas = confettiCanvas;
    const ctx = canvas.getContext('2d');
    let W = canvas.width = window.innerWidth;
    let H = canvas.height = window.innerHeight;
    const pieces = [];
    const colors = ['#ff5fb4','#ffd166','#7afcff','#8b5cf6','#ff8a66','#ffd6fb'];

    for(let i=0;i<100;i++){
      pieces.push({
        x: Math.random()*W,
        y: Math.random()*H - H*0.3,
        r: 6 + Math.random()*10,
        color: colors[Math.floor(Math.random()*colors.length)],
        tilt: Math.random()*10 - 10,
        tiltAngle: Math.random()*Math.PI
      });
    }

    let t = 0;
    function draw(){
      ctx.clearRect(0,0,W,H);
      for(let p of pieces){
        p.tiltAngle += 0.05;
        p.y += Math.sin(t/10) + 2 + p.r/8;
        p.x += Math.sin(t/20);
        p.tilt = Math.sin(p.tiltAngle) * 15;
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.tilt * Math.PI/180);
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.r/2, -p.r/2, p.r, p.r*0.6);
        ctx.restore();
      }
      t++;
      if(t < 200) requestAnimationFrame(draw);
      else ctx.clearRect(0,0,W,H);
    }
    draw();
    window.addEventListener('resize', ()=>{ W = canvas.width = window.innerWidth; H = canvas.height = window.innerHeight; });
  } catch(e){
    console.warn('confetti not supported', e);
  }
}

/* ======== Schedule daily update at midnight (optional) ======== */
function scheduleMidnightUpdate(){
  const now = new Date();
  const tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate()+1);
  const msUntilMidnight = tomorrow.getTime() - now.getTime();
  setTimeout(()=> {
    updateDailyMessage();
    setInterval(updateDailyMessage, 24*60*60*1000);
  }, msUntilMidnight + 100);
}
scheduleMidnightUpdate();
</script>
</body>
</html>
